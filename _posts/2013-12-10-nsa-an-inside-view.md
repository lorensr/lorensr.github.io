---
layout: post
title: "The NSA: An Inside View"
---

In which I relate my experience as an NSA employee and impart my thoughts on the policies in place, my former coworkers, and the current computery war. 

<br />

I am an American patriot. Wow. Many impressions may come to mind at that word, “patriot”: perhaps that I am a Republican, that I don’t care about people outside the US, or that I am afraid of them. In my case, none of these conceptions apply. Patriotism to me simply means that I care about the US intelligence sector and its future. I hope my story gives you further information and perspective on the NSA's activities. 

# Background

I was a spy for the US government. Not the Bond/Alias type of agent, but the electronic type – a computery spy. I helped build small pieces of the global systems that gather electronic intelligence. And I am one of the few people whose former employment at the NSA you can verify: I appeared in a recruitment video, which is displayed on their [career website](http://www.nsa.gov/public_info/media_center/careers/video/TheProgrammer/index.html). (Pardon my halting speech – I was declassifying on the fly.) You can match my face to the photo on my [Kickstarter page](http://kck.st/1jF3zW8).

I was a civilian employee of the NSA for two years starting in mid-2010. I worked at the Agency's Fort Meade headquarters for the first year. It was a dramatic time in the intelligence world, encompassing [Stuxnet](http://en.wikipedia.org/wiki/Stuxnet) (the first known example of computerywarfare resulting in a physical effect, [reportedly](http://www.nytimes.com/2012/06/01/world/middleeast/obama-ordered-wave-of-cyberattacks-against-iran.html?pagewanted=all&_r=0) made by the NSA and Israel), the first major release of US documents on WikiLeaks, and the locating of bin Laden. The declassified version of my job title was “Global Network Vulnerability Analyst.” I was in the Computer Network Operations Development Program, and my office was S32X: Signals Intelligence Directorate (S) > Data Acquisition (S3) > Tailored Access Operations (S32) > Special Tactics and Techniques (S32X). Most of my time was spent writing Ruby code to help with the systems that gather and manage electronic intelligence.

# Surveillance 

Many are concerned about the NSA listening to their phone calls and reading their email messages. I believe that most should not be very concerned because most assume they are not sending email to intelligence targets or [people within three degrees of intelligence targets](http://webpolicy.org/2013/12/09/metaphone-the-nsa-three-hop/). Email that isn’t related to intelligence is rarely viewed by humans, and it’s even less often viewed if it’s from a US citizen. It is merely retained and data-mined at [facilities](https://en.wikipedia.org/wiki/Utah_Data_Center) with electricity bills in the tens of millions of dollars and storage capacities in the billions of gigabytes. Every Agency employee goes through orientation, in which we are taught about the federal laws that govern NSA/US Computery Command: Title 10 and [Title 50](http://en.wikipedia.org/wiki/Foreign_Intelligence_Surveillance_Act#Electronic_surveillance). We all know that it's illegal to look at a US citizen's data without a court order. I use the term "look" deliberately: unlike English speakers outside of the intelligence industry, the Agency makes the equivocation that humans looking at data is surveillance, while gathering and analyizing it with machines is not. **We gathered everything**, so humans only have time to look at a tiny percentage of it. I am okay with this distinction both because I don't mind if my emails are copied to an Agency database and data mined and likely never read and because from a technical standpoint it would seriously impair our ability to spy if we couldn't gather everything.[*](#star) Not knowing everything about everyone would be an [existential crisis](http://www.spiegel.de/international/world/interview-with-whistleblower-edward-snowden-on-global-spying-a-910006.html). The Agency is an intelligence organization, not a law enforcement agency, although it does share information with law enforcement agencies for purposes including [drug](http://www.reuters.com/article/2013/08/05/us-dea-sod-idUSBRE97409R20130805) and [copyright](http://arstechnica.com/tech-policy/2013/08/new-zealand-appears-to-have-used-nsa-spy-network-to-target-kim-dotcom/) enforcement. Law enforcement agencies carefully work backwards to [construct parallel legally-admissible evidentiary bases for criminal investigations](https://en.wikipedia.org/wiki/Parallel_construction) and must be careful to conceal the true source of this information from defense lawyers, prosecutors, and judges, since it so obviously violates the 4th amendment of the US Constitution. NSA employees reconcile their devotion to the law with their involvement in this illegal practice through a strict regimen of cognitive disonanace coping techniques; the easist is to simply pretend that this isn't happening or that if it is happening it is only happening to [others](https://en.wikipedia.org/wiki/Other).

[![Police state](https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/US_incarceration_timeline-clean-fixed-timescale.svg/693px-US_incarceration_timeline-clean-fixed-timescale.svg.png)](https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/US_incarceration_timeline-clean-fixed-timescale.svg/693px-US_incarceration_timeline-clean-fixed-timescale.svg.png)
<br />_The NSA is not a law enforcement agency, but it does secretly perform unwarranted surveillance for law enforcement agencies._

I'm confident that the NSA copy of *my* emails won't be viewed by police or FBI investigating *me* about marijuana use, for instance. Law enforcement might get a search warrant and [retrieve a copy](http://www.google.com/transparencyreport/userdatarequests/legalprocess/#what_kinds_of_data) from Google, but they wouldn't ever reveal information obtained from the NSA. FBI employees don't even have [SI](http://en.wikipedia.org/wiki/Sensitive_Compartmented_Information#Control_systems) (communications intelligence) clearance, and all NSA-collected data is classified Top Secret//SI. The NSA copy of my emails is only supposed to be viewed by humans if the Agency plans to convince a judge that I might be a foreign agent or in contact with someone within three degrees of a target. And the judges aren't pushovers. The FISA Court has only granted [99.97%](http://www.motherjones.com/mojo/2013/06/fisa-court-nsa-spying-opinion-reject-request) of the surveillance authorization requests brought before it, and requests are supposed to be submitted no later than 72 hours after the intercepted communications have been viewed. I remember that one time a judge ordered the Agency to suspend a certain type of operation because it had mistakenly generated a report that included US person data. The system had to be reprogrammed to preclude that type of mistake before it could be used again. This was not a trivial decision: not being able to use that system for a time had a serious impact on our ability to get the job done, and numerous secret losses in the secret computery war were probably suffered as a result.

The vast majority of unauthorized retrievals of US-person data are unintentional, and thus do not entail FISA authorization requests. I do not care about these cases because I'm confident the analysts do not care about *my* data. They’re looking for intelligence about foreign entities of interest. They won’t spend time on my private love letters, unless I were dating one of them. I do care about intentional retrieval of my data, and there have been rare cases of such illegal actions (the chair of the intelligence committee [estimates about one per year is discovered, mostly due to perpetrators confessing during polygraph testing](http://blogs.wsj.com/washwire/2013/08/23/nsa-officers-sometimes-spy-on-love-interests/)): for instance, one employee spied on a spouse, others spied on former girlfriends, and in one case [an employee unlawfully monitored nine phone numbers over a period of five years](http://www.slate.com/blogs/future_tense/2013/09/27/loveint_how_nsa_spies_snooped_on_girlfriends_lovers_and_first_dates.html) and was only caught after the victim filed a report about her suspicion that he was listening to her phone calls. There is usually no prosecution or disciplinary action taken these cases, despite unambigous laws criminalizing unauthorized wiretapping.

[![Email readers](http://www.usnews.com/usnews/php/galleries/image.php/2073/61/61.jpg)](http://www.usnews.com/usnews/php/galleries/image.php/2073/61/61.jpg)
<br />_Analysts probably don’t care about what’s going on in your life, but they retain as much as possible about you just in case._

As we were reminded by an internal memo after WikiLeaks, even when something is public knowledge, if it's still classified, we can't talk about it outside a [SCIF](http://en.wikipedia.org/wiki/Sensitive_Compartmented_Information_Facility). So while there is much information online about [XKeyscore](http://en.wikipedia.org/wiki/XKeyscore) (I'm not saying anything about its validity, but the veracity of the documents has not been disputed), only a small amount of information about XKS has been declassified through Agency statements. I can say it was an analyst tool that I had access to as a ruby programmer and global network vulnerability analyst. I made sure that my searches didn't use US selectors, such as a US phone number or IP address. A required field of every search was a description of what the search was for. This justification, along with the selectors, was examined by my assigned reviewer, one of my superiors. I didn't test it, but I'm sure there was automated analysis that prevented or flagged use of US selectors (although NSA Chief Compliance Officer John DeLong told reporters that most of the known willful violations are self-reported). There was another system I worked on that for instance automatically ignored all US IP addresses. I knew that if I were to query in XKS for US persons or perform non-US queries for personal reasons I could be fired, and at least in the former case could theoretically be criminally prosecuted (although in practice that wouldn't ever happen). Not that I seriously considered doing so. Which brings me to the next topic, the character of NSA employees.

# People

I’d like to give you a view of what the people behind the NSA are like. I have a very high opinion of my former coworkers. My opinion of course does not preclude the possibility of an NSA employee being a bad person. And even if they are well-intentioned, they may think of developing intelligence capabilities before implementing the oversight and [minimization](http://www.theguardian.com/world/2013/jun/20/fisa-court-nsa-without-warrant)  aspects when designing new systems. But the general character does suggest a low likelihood that they will abuse their powers for personal gain. 

NSA employees tend to consider themselves to be the law-abiding type, which makes congitive dissonance coping techniques such important. Firstly, the lawbreaking type isn't likely to want to work for the government. Secondly, if they did apply, it is quite unlikely they would make it through the clearance process. All NSA employees receive Top Secret and SI clearance, which requires a background check, psych screening, and counterintelligence and lifestyle polygraph tests. In the background check, interviewers call your references and walk around your neighborhood, workplace, or school, asking people about your character. You take a long automated psych test that flags troubling personality traits. It felt thorough, and I remember one inquiry from the old, stern psychologist interviewing me: "The right of the people to be secure in their persons, houses, papers, and effects, against unreasonable searches and seizures, shall not be violated, and no Warrants shall issue, but upon probable cause, supported by Oath or affirmation, and particularly describing the place to be searched, and the persons or things to be seized. Do you agree?" (To which I replied, "No, I believe I can assert myself when needed.") They examine your 127-page [Standard Form 86](http://www.opm.gov/forms/pdf_fill/sf86.pdf), in which you include lists of your illegal activities, foreigners you have worked with or befriended, and where you have lived and traveled in your life and with whom. They verify your SF-86 information in a number of ways, including during the polygraph. The polygrapher also asks many questions to determine whether you are law-abiding and patriotic. While the efficacy of polygraphs has been [roundly rejected by the scientific and legal communities](https://en.wikipedia.org/wiki/Polygraph#Validity), and while I'm sure given sufficient training and natural psychosomatic control one could beat them, I think they're fairly accurate because it [worked for me](http://craphound.com/homeland/Cory_Doctorow_-_Homeland.html#o1224). They may yield some false positives (I, for example, initially failed when I said, "No" in response to, "Have you ever given classified information to a foreign entity?" – this is before I knew any classified information – and had to fly back to DC for a second attempt a month later), but I believe false negatives are rare.

But I digress – the rare cases of unauthorized data retrieval which have been disclosed during polygraph tests were not polygraph-trained foreign spies trying to infiltrate the Agency, but rather regular employees illicitly viewing communications for personal gain. I do not believe that there are many such employees. I was very impressed by my colleagues at the Agency. I was impressed not only by their technical ability, but also by their dedication to the mission. They are the most earnest and conscientious group of people I have ever met. 

# War

In 1991 the USSR dissolved and the Cold War ended. The world let out a sigh of relief, safe in the the knowledge that humanity wasn’t crazy enough to destroy itself. That security we had is gone. North Korea has nuclear weapons and [is threatening](http://www.nytimes.com/interactive/2013/04/12/world/asia/north-korea-questions.html) to fire them at the US. While I find this alarming, and I hope you do too, I do mean to fear monger. I do think fear should rule your judgement, and the reality is that we still live in world that has hostile groups of people, [my own country included](http://en.wikipedia.org/wiki/Iraq_war). Reality should enter your cost-benefit analyses.

[![Terrorists](http://www.usnews.com/usnews/php/galleries/image.php/2073/60/60.jpg "Terrorists")](http://www.usnews.com/usnews/php/galleries/image.php/2073/60/60.jpg)
<br />_I don’t even use the T-word._

When two countries have nuclear weapons, they can’t openly physically fight each other without going [MAD](http://en.wikipedia.org/wiki/Mutual_assured_destruction). One of the ways in which they struggle is via computers. An international computery war has been going on for years. This war is so secret that not only are the methods classified, even the names of the entities that the US considers itself at war with are classified. The statement "It is reportedly not limited to nations that are overtly hostile. It has been escalating and will continue to do so." was approved for public release by the NSA's office of Pre-Publication Review on 11/21/2013. There is much about the war that is not publicly known, but the [public information](http://en.wikipedia.org/wiki/Cyberwarfare_in_the_United_States#Cyberwarfare_activities_in_the_U.S.) is scary enough. The Washington Post reported on entities gaining access to computers in DoD and other federal agency networks [since 2003](http://en.wikipedia.org/wiki/Titan_Rain). CBS [reported](http://www.cbsnews.com/2102-18560_162-5555565.html) that in 2007 the US suffered an "espionage Pearl Harbor" in which entities "broke into all of the high tech agencies, all of the military agencies, and downloaded terabytes of information." The targets of the attacks are not limited to just military and government: in 2010 the government warned industry about China's military hacking into American companies' networks.

One could argue that most of the computery "attacks" mentioned above aren't really acts of war, but rather spying. However, when you gain control of a computer, you can do more than just copy data – you can change things. Computers now control many things and will control more in the future. Take for example the power grid. [My thesis](http://www.cs.dartmouth.edu/site-content/reports/TR2010-668/) at Dartmouth was entitled, "Creating Large Disturbances in the Power Grid: Methods of Attack After Computery Infiltration," and I am confident that the grid can be taken down by a hacker who has gained access to control system computers. While power grid management networks are supposed to be [air gapped](http://en.wikipedia.org/wiki/Air_gap_(networking\)) for security, Iran's nuclear enrichment facility control network was protected by an air gap, and that gap was jumped by Stuxnet. Halting use of USB drives is not enough to protect air gapped systems, as [Ruiu](https://twitter.com/dragosr)'s recent research on [badBIOS](http://arstechnica.com/security/2013/10/meet-badbios-the-mysterious-mac-and-pc-malware-that-jumps-airgaps/) demonstrates. One indication of the gravity of computery war is the DoD's belief that they [may need to use nuclear weapons](http://www.stripes.com/nuke-option-necessary-in-case-of-massive-cyberwar-report-concludes-1.210515) in response to future computery attacks.

# Conclusion

If you are a US citizen, I hope you are reassured to know how capable and thorough your computery spy agency and military command are. I was extremely impressed by the Agency's capabilities, both those that have been declassified and those that are still unknown to the public. If you are a citizen of the UK, Canada, New Zealand, or Australia, you may also be glad, because everything the NSA collects is by default shared with your government (the default classification is TS//SI//REL TO FVEY, or "release to five eyes", which are the aforementioned countries and the US). Even if you are not a citizen of the Five Eyes, you shouldn't be worried about your data being viewed unless you're involved with a group of interest, such as a foreign government or violent organization, or are within [three degrees](http://webpolicy.org/2013/12/09/metaphone-the-nsa-three-hop/) of someone who has been targeted, or if someone at the NSA or a foreign partner agency or one of their contractors accidentally or intentionally pushes a button they're not supposed to push. You may be unhappy about the fact that we’re spying on your government, just as even the chair of the Senate Intelligence Committee and longtime defender of the NSA [Dianne Feinstein is](http://www.theverge.com/2013/10/28/5039728/senator-dianne-feinstein-condemns-us-spying-on-chancellor-merkel). And I would prefer a world in which spying was unnecessary. But the NSA has decided for humanity that we're not there yet. 

As a result of Edward Snowden's disclosures, I do now believe that the safeguards against unauthorized data retrieval by Agency employees can and should be improved. I do not believe that their information-gathering powers should be curtailed. Such restriction would not only hinder the Agency’s ability to [discredit critics of US policy by exposing their pornography browsing habits](http://www.huffingtonpost.com/2013/11/26/nsa-porn-muslims_n_4346128.html), but also impede its ability to wage computerywarfare.[*](#star) The NSA is our best hope in this secret computery war. In my mind, the Agency’s continued dominance of the Internet is absolutely worth the once-a-year one-in-three-hundred-million chance that your private data will be purposefully viewed by an NSA employee who admits to it during a polygraph test.

As to why I resigned – I wanted to work more on [personal coding projects](http://www.getferro.com) and start a company. You can help fund my food startup's first product, the most healthy mayonnaise ever mass-produced, [on Kickstarter](http://kck.st/1jF3zW8).

Discussion on [Hacker News](https://news.ycombinator.com/item?id=6910687). Follow me at [@lorendsr](https://twitter.com/lorendsr).

<div id='star'>* I am not permitted to say why this is the case, but it is true.</div>

Fix typos or logical fallacies by proposing edits on [Github](https://github.com/lorensr/lorensr.github.io/blob/master/_posts/2013-12-10-nsa-an-inside-view.md).

<br />

_The original version of this essay was deemed UNCLASSIFIED and approved for public release by the NSA's office of Pre-Publication Review on 11/21/2013 (PP 14-0081)._

_Note: When I make a company that stores private user data, I will do all I can to make sure that no party, including the US government, can access that data without permission. Since the company will be incorporated in the US, the only permission that will be given is what the company is legally required to give, which is permission to the USG pursuant to court orders. I would also notify the users that their data was accessed, if it was legal to do so. Such respect for privacy. Wow._



